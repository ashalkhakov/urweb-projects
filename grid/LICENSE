Taken directly from Adam Chlipala's examples.